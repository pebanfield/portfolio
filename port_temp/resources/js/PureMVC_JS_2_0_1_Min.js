var Controller=new Class({view:null,commandMap:{},initialize:function(){this.initializeController()},initializeController:function(){this.view=View.getInstance()},executeCommand:function(a){var c=this.commandMap[a.getName()];if(!c){return}var b=new c();b.execute(a)},registerCommand:function(a,b){if(!this.commandMap[a]){this.view.registerObserver(a,new Observer(this.executeCommand,this))}this.commandMap[a]=b},hasCommand:function(a){return this.commandMap[a]!=null},removeCommand:function(a){if(!this.hasCommand(a)){return}this.view.removeObserver(a,this);delete this.commandMap[a]}});Controller.getInstance=function(){if(Controller.instance==undefined){Controller.instance=new Controller()}return Controller.instance};var Model=new Class({initialize:function(){this.initializeModel()},proxyMap:{},registerProxy:function(a){this.proxyMap[a.getProxyName()]=a;a.onRegister()},retrieveProxy:function(a){return this.proxyMap[a]},hasProxy:function(a){return this.proxyMap[a]!=null},removeProxy:function(b){var a=this.proxyMap[b];if(a){delete this.proxyMap[b];a.onRemove()}return a},initializeModel:function(){}});Model.getInstance=function(){if(Model.instance==undefined){Model.instance=new Model()}return Model.instance};var View=new Class({mediatorMap:{},observerMap:{},registerObserver:function(b,a){var c=this.observerMap[b];if(c){c.push(a)}else{this.observerMap[b]=[a]}},notifyObservers:function(e){var c=e.getName();if(this.observerMap[c]==null){return}var f=this.observerMap[c].concat();var a=f.length;for(var d=0;d<a;d++){var b=f[d];b.notifyObserver(e)}},removeObserver:function(d,c){var e=this.observerMap[d];var b=e.length;while(b--){var a=e[b];if(a.compareNotifyContext(c)){e.splice(b,1);break}}if(!e.length){delete this.observerMap[d]}},registerMediator:function(e){var c=e.getMediatorName();if(this.mediatorMap[c]){return}this.mediatorMap[c]=e;var f=e.listNotificationInterests();var a=f.length;if(a){var b=new Observer(e.handleNotification,e);for(var d=0;d<a;d++){this.registerObserver(f[d],b)}}e.onRegister()},retrieveMediator:function(a){return this.mediatorMap[a]},removeMediator:function(a){var c=this.mediatorMap[a];if(c){var d=c.listNotificationInterests();var b=d.length;while(b--){this.removeObserver(d[b],c)}delete this.mediatorMap[a];c.onRemove()}return c},hasMediator:function(a){return this.mediatorMap[a]!=null}});View.getInstance=function(){if(View.instance==undefined){View.instance=new View()}return View.instance};var Notification=new Class({name:null,body:null,type:null,initialize:function(b,a,c){this.name=b;this.body=a;this.type=c},getName:function(){return this.name},setBody:function(a){this.body=a},getBody:function(){return this.body},setType:function(a){this.type=a},getType:function(){return this.type},toString:function(){var a="Notification Name: "+this.getName();a+="\nBody:"+((this.body==null)?"null":this.body.toString());a+="\nType:"+((this.type==null)?"null":this.type);return a}});var Facade=new Class({view:null,model:null,controller:null,initialize:function(){this.initializeFacade()},initializeFacade:function(){this.initializeModel();this.initializeController();this.initializeView()},initializeModel:function(){this.model=Model.getInstance()},initializeController:function(){this.controller=Controller.getInstance()},initializeView:function(){this.view=View.getInstance()},registerCommand:function(a,b){this.controller.registerCommand(a,b)},removeCommand:function(a){this.controller.removeCommand(a)},hasCommand:function(a){return this.controller.hasCommand(a)},registerProxy:function(a){this.model.registerProxy(a)},retrieveProxy:function(a){return this.model.retrieveProxy(a)},removeProxy:function(a){this.model.removeProxy(a)},hasProxy:function(a){return this.model.hasProxy(a)},registerMediator:function(a){this.view.registerMediator(a)},retrieveMediator:function(a){return this.view.retrieveMediator(a)},removeMediator:function(a){return this.view.removeMediator(a)},hasMediator:function(a){return this.view.hasMediator(a)},sendNotification:function(c,a,b){this.notifyObservers(new Notification(c,a,b))},notifyObservers:function(a){this.view.notifyObservers(a)}});Facade.getInstance=function(){if(Facade.instance==undefined){Facade.instance=new Facade()}return Facade.instance};var Notifier=new Class({facade:null,initialize:function(){this.facade=Facade.getInstance()},sendNotification:function(c,a,b){this.facade.sendNotification(c,a,b)}});var Observer=new Class({notify:null,context:null,initialize:function(a,b){this.notify=a;this.context=b},setNotifyMethod:function(a){this.notify=a},setNotifyContext:function(a){this.context=a},getNotifyMethod:function(){return this.notify},getNotifyContext:function(){return this.context},notifyObserver:function(a){this.notify.apply(this.context,[a])},compareNotifyContext:function(a){return a===this.context}});var SimpleCommand=new Class({Extends:Notifier,initialize:function(){this.parent()},execute:function(a){}});var MacroCommand=new Class({Extends:Notifier,subCommands:[],initialize:function(){this.initializeMacroCommand()},initializeMacroCommand:function(){},addSubCommand:function(a){this.subCommands.push(a)},execute:function(d){var a=this.subCommands.length;for(var b=0;b<a;b++){var e=this.subCommands[b];var c=new e();c.execute(d)}}});var Mediator=new Class({Extends:Notifier,mediatorName:null,viewComponent:null,initialize:function(a,b){this.parent();this.mediatorName=a||Mediator.NAME;this.viewComponent=b},listNotificationInterests:function(){return[]},getMediatorName:function(){return this.mediatorName},getViewComponent:function(){return this.viewComponent},setViewComponent:function(a){this.viewComponent=a},handleNotification:function(a){},onRegister:function(){},onRemove:function(){}});Mediator.NAME="Mediator";var Proxy=new Class({Extends:Notifier,proxyName:null,data:null,initialize:function(b,a){this.parent();this.proxyName=b||Proxy.NAME;this.data=a},getProxyName:function(){return this.proxyName},setData:function(a){this.data=a},getData:function(){return this.data},onRegister:function(){},onRemove:function(){}});Proxy.NAME="Proxy";